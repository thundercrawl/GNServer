webpackJsonp([12],{600:function(e,o,t){t(651);var s=t(225)(t(613),t(637),"data-v-2b7223ba",null);e.exports=s.exports},613:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=t(228),i=t.n(s);o.default={data:function(){return{buttons:{add:!1,update:!1,perAdd:!1,perUpdate:!1,perDelete:!1},checkStrictly:!0,defaultExpand:!1,updateDisable:!0,multipleSelection:[],defaultProps:{code:"code",label:"label",nodeData:"nodeData",isLeaf:"isLeaf"},nodeData:{tid:"",resourceCode:"",resourceName:"",router:"",component:"",parentCode:"",resourceLevel:"",resourceType:"",displayOrder:"",nodeIcon:"",leafFlag:"",notes:"",permissions:[]},resourceDialogTitle:"",resourceDialogVisible:!1,resourceDialogCommand:"",form:{tid:"",resourceCode:"",resourceName:"",router:"",component:"",parentCode:"",resourceLevel:"",resourceType:"",displayOrder:"",nodeIcon:"",leafFlag:"",notes:""},rules:{resourceCode:[{required:!0,message:"请输入菜单编码",trigger:"blur"}],resourceName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],parentCode:[{required:!0,message:"请选择父级菜单",trigger:"blur"}]},checkPermissions:[],addPermissionDisable:!0,updatePermissionDisable:!0,deletePermissionDisable:!0,permissionDialogTitle:"",permissionVisible:!1,permissionDialogCommand:"",permissionEditResourceCode:"",permissionForm:{tid:"",resourceTid:"",permissionCode:"",permissionName:"",editAble:!0},permissionRules:{permissionCode:[{required:!0,message:"请输入权限编码",trigger:"blur"}],permissionName:[{required:!0,message:"请输入权限名称",trigger:"blur"}]}}},methods:{checkSelectedMenuSingle:function(){return this.multipleSelection.length>1?(this.$message({message:"只能选择其中一个菜单操作",type:"warning"}),!1):this.nodeData.resourceCode==JSON.parse(this.multipleSelection[0].nodeData).resourceCode||(this.$alert("选中菜单与展示数据不一致，请单击需要操作菜单！","提示",{confirmButtonText:"确定",callback:function(e){}}),!1)},onPermissionAdd:function(){if(this.checkSelectedMenuSingle()){this.permissionDialogTitle="新增权限",this.permissionVisible=!0,this.permissionDialogCommand="add";var e=JSON.parse(this.multipleSelection[0].nodeData);this.permissionForm.resourceTid=e.tid,this.permissionEditResourceCode=e.resourceCode}},onPermissionUpdate:function(){if(this.checkSelectedMenuSingle()){if(this.checkPermissions.length>1)return void this.$message({message:"只能选择其中一条数据进行修改",type:"warning"});this.permissionDialogTitle="更新权限",this.permissionDialogCommand="update";var e=this.checkPermissions[0],o=JSON.parse(this.multipleSelection[0].nodeData);this.permissionEditResourceCode=o.resourceCode;for(var t=0,s=o.permissions.length;t<s;t++){var i=o.permissions[t];if(e==i.permissionName){this.permissionForm=i;break}}this.permissionVisible=!0}},permissionHandleSubmit:function(){var e=this,o="";"add"==this.permissionDialogCommand?o=this.$global.remote().permissionAdd:"update"==this.permissionDialogCommand&&(o=this.$global.remote().permissionUpdate),this.$http.post(o,{resourceCode:this.permissionEditResourceCode,permissionDTO:this.permissionForm},function(o){e.updateTreeNode(o.result),e.permissionCloseDialog()},function(o){e.$message.error(o.message)})},onPermissionDelete:function(){var e=this;this.checkSelectedMenuSingle()&&this.$confirm("确认删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var o=JSON.parse(e.multipleSelection[0].nodeData);e.permissionEditResourceCode=o.resourceCode;for(var t=[],s=0,i=e.checkPermissions.length;s<i;s++)!function(o,s){var i=e.checkPermissions[o];e.nodeData.permissions.forEach(function(e){i==e.permissionName&&t.push(e.tid)})}(s);e.$http.post(e.$global.remote().permissionDelete,{resourceCode:e.permissionEditResourceCode,ids:t},function(o){e.updateTreeNode(o.result),e.checkPermissions=[],e.$message({type:"success",message:"删除成功!"})},function(o){e.$message.error(o.message)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},permissionCloseDialog:function(){this.$refs.permissionForm.resetFields(),this.permissionVisible=!1,this.resetPermissionFormData()},resetPermissionFormData:function(){this.permissionForm={tid:"",resourceTid:"",permissionCode:"",permissionName:"",editAble:!0}},handlePermissionChange:function(){this.checkPermissions.length>0?(this.updatePermissionDisable=!1,this.deletePermissionDisable=!1):(this.updatePermissionDisable=!0,this.deletePermissionDisable=!0)},onSearch:function(){},onAdd:function(){this.resourceDialogVisible=!0,this.resourceDialogTitle="新增菜单",this.resourceDialogCommand="add"},onUpdate:function(){var e=this;if(this.multipleSelection.length>1)return void this.$message({message:"只能选择其中一条数据进行修改",type:"warning"});this.resourceDialogTitle="修改菜单",this.resourceDialogCommand="update";var o=JSON.parse(this.multipleSelection[0].nodeData).tid;this.$http.get(this.$global.remote().resourceFind,{tid:o},function(o){var t=o.result;e.$tools.isNotEmpty(t)&&(e.form=t,e.form.active="Y"==t.active,e.form.leafFlag="Y"==t.leafFlag),e.resourceDialogVisible=!0},function(o){e.$message.error(o.message)})},updateTreeNode:function(e){this.nodeData=e;var o={code:e.resourceCode,label:e.resourceName,nodeData:i()(e),isLeaf:e.leafFlag},t=this.$refs.tree.getNode(e.resourceCode);t.data=o,t.checked=!0;for(var s=0,r=this.multipleSelection.length;s<r;s++)if(JSON.parse(this.multipleSelection[s].nodeData).resourceCode==e.resourceCode){this.multipleSelection.splice(s,1);break}this.multipleSelection.push(o)},resourceHandleSubmit:function(){var e=this,o="",t={};t.resourceDTO=this.form,t.resourceDTO.active=this.form.active?"Y":"N",t.resourceDTO.leafFlag=this.form.leafFlag?"Y":"N","add"==this.resourceDialogCommand?o=this.$global.remote().resourceAdd:"update"==this.resourceDialogCommand&&(o=this.$global.remote().resourceUpdate),this.$http.post(o,t,function(o){var t=o.result;if(e.nodeData=t,"update"==e.resourceDialogCommand)e.updateTreeNode(t);else if("add"==e.resourceDialogCommand){var s=e.form.parentCode,r={code:e.form.resourceCode,label:e.form.resourceName,nodeData:i()(t),isLeaf:e.form.leafFlag};e.$refs.tree.append(r,s)}e.resourceCloseDialog()},function(o){e.$message.error(o.message)})},resourceCloseDialog:function(){this.resourceDialogVisible=!1,this.$refs.form.resetFields(),this.resetFormData()},resetFormData:function(){this.form={tid:"",resourceCode:"",resourceName:"",router:"",component:"",parentCode:"",resourceLevel:"",resourceType:"",displayOrder:"",nodeIcon:"",leafFlag:"",notes:""}},onDelete:function(){var e=this;this.$confirm("确认删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var o=[];e.multipleSelection.forEach(function(e){o.push(JSON.parse(e.nodeData).tid)}),e.$http.post(e.$global.remote().resourceDelete,{ids:o},function(o){e.$message({type:"success",message:"删除成功!"})},function(o){e.$message.error(o.message)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleCheckChange:function(e,o){o?this.multipleSelection.push(e):this.$tools.removeArrayItemByValue(this.multipleSelection,e),this.multipleSelection.length>0?(this.updateDisable=!1,this.addPermissionDisable=!1):(this.updateDisable=!0,this.addPermissionDisable=!0)},loadNode:function(e,o){if(0===e.level)return o([{code:"console_1",label:"console系统",nodeData:i()(""),isLeaf:!1}]);if(e.level>=1){var t=e.data.code;this.loadData(t,o)}},loadData:function(e,o){var t=this;this.$http.get(this.$global.remote().resourceFindByParentCode,{parentCode:e},function(e){var t=e.result;if(null==t||void 0==t||0==t.length)return o([]);for(var s=new Array,r=0,a=t.length;r<a;r++){var l=t[r];s.push({code:l.resourceCode,label:l.resourceName,nodeData:i()(l),isLeaf:"Y"==l.leafFlag})}return o(s)},function(e){t.$message.error(e.message)})},handleNodeClick:function(e,o){if("console_1"!=e.code){var t=JSON.parse(e.nodeData);null!=t&&void 0!=t&&(this.nodeData=t,this.$refs.tree.setCheckedNodes([{code:t.resourceCode}]))}},handleNodeExpand:function(e){},handleNodeCollapse:function(e){}},computed:{activeShow:function(){return this.$global.transformActive(this.nodeData.active)},leafFlagShow:function(){return"Y"==this.nodeData.leafFlag?"是":"否"},resourceLevelShow:function(){return this.$global.getValueNameByTermsCodeAndValueCode("RESOURCES_LEVEL",this.nodeData.resourceLevel)},resourceTypeShow:function(){return this.$global.getValueNameByTermsCodeAndValueCode("JURISDICTION_TYPE",this.nodeData.resourceType)},resourceLevelItems:function(){return this.$global.getTermsValueStore("RESOURCES_LEVEL")},resourceTypeItems:function(){return this.$global.getTermsValueStore("JURISDICTION_TYPE")},resourceOptions:function(){return this.$global.getMenuCodeValueStore()}},mounted:function(){var e=this.$global.getUserPermissions();this.buttons.add=e.indexOf(this.$global.remote().resourceAdd)>=0,this.buttons.update=e.indexOf(this.$global.remote().resourceUpdate)>=0,this.buttons.perAdd=e.indexOf(this.$global.remote().permissionAdd)>=0,this.buttons.perUpdate=e.indexOf(this.$global.remote().permissionUpdate)>=0,this.buttons.perDelete=e.indexOf(this.$global.remote().permissionDelete)>=0}}},618:function(e,o,t){o=e.exports=t(226)(!1),o.push([e.i,".user-management-box[data-v-2b7223ba]{width:100%;min-width:1000px}.form-box[data-v-2b7223ba]{width:100%}.table-top[data-v-2b7223ba]{border-top:1px solid #eee}.el-header[data-v-2b7223ba]{background-color:#b3c0d1;color:#333;line-height:60px}.form-container[data-v-2b7223ba]{position:relative}div.form-div[data-v-2b7223ba]{height:47.8px;position:absolute;top:0;left:0}div.form-aside[data-v-2b7223ba]{position:absolute;top:46.8px;left:0}div.form-container[data-v-2b7223ba]{position:absolute;left:200px;right:0}div.form-div .el-form-item--mini.el-form-item[data-v-2b7223ba]{margin-top:10px;margin-left:5px}div.form-container .el-main[data-v-2b7223ba]{padding:0}.el-tree[data-v-2b7223ba]{width:180px!important}.container-top[data-v-2b7223ba]{background-color:#a0cfff;color:#fff;height:40px;line-height:40px;padding-left:10px;font-size:16px;border-radius:3px;border:none}.mt20[data-v-2b7223ba]{margin-top:20px}.from-item-container[data-v-2b7223ba]{position:relative}.form-item-left[data-v-2b7223ba],.form-item-right[data-v-2b7223ba]{position:absolute;width:50%}.form-item-left[data-v-2b7223ba]{top:0;left:0}.form-item-right[data-v-2b7223ba]{top:0;left:50%}",""])},637:function(e,o){e.exports={render:function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"user-management-box"},[t("div",{staticClass:"form-box"},[t("el-form",{attrs:{inline:!0,size:"mini"}},[t("el-form-item",[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.buttons.add,expression:"buttons.add"}],attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("新增菜单")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.buttons.update,expression:"buttons.update"}],attrs:{type:"primary",disabled:e.updateDisable},on:{click:e.onUpdate}},[e._v("修改菜单")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.buttons.perAdd,expression:"buttons.perAdd"}],attrs:{type:"primary",disabled:e.addPermissionDisable},on:{click:e.onPermissionAdd}},[e._v("新增权限")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.buttons.perUpdate,expression:"buttons.perUpdate"}],attrs:{type:"primary",disabled:e.updatePermissionDisable},on:{click:e.onPermissionUpdate}},[e._v("修改权限")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.buttons.perDelete,expression:"buttons.perDelete"}],attrs:{type:"primary",disabled:e.deletePermissionDisable},on:{click:e.onPermissionDelete}},[e._v("删除权限")])],1)],1)],1),e._v(" "),t("div",[t("el-container",{staticClass:"form-container",staticStyle:{border:"1px solid #eee"}},[t("div",{staticClass:"form-div"},[t("el-form",{attrs:{inline:!0,size:"mini"}},[t("el-form-item",{staticStyle:{width:"100px"}},[t("el-input",{attrs:{placeholder:"菜单名称"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("查询")])],1)],1)],1),e._v(" "),t("div",{staticClass:"form-aside"},[t("el-tree",{ref:"tree",attrs:{lazy:"","show-checkbox":"","node-key":"code","check-strictly":e.checkStrictly,load:e.loadNode,props:e.defaultProps,"default-expand-all":e.defaultExpand},on:{"check-change":e.handleCheckChange,"node-expand":e.handleNodeExpand,"node-collapse":e.handleNodeCollapse,"node-click":e.handleNodeClick}})],1),e._v(" "),t("div",{staticClass:"form-container"},[t("div",{staticClass:"container-top"},[e._v("菜单基本信息")]),e._v(" "),t("el-container",[t("el-main",{staticStyle:{padding:"20px",height:"320px"}},[t("el-form",{attrs:{"label-position":"right","label-width":"110px",model:e.nodeData,size:"small",inline:!1}},[t("div",{staticClass:"from-item-container"},[t("div",{staticClass:"form-item-left"},[t("el-form-item",{attrs:{label:"菜单编码："}},[e._v("\n                                        "+e._s(e.nodeData.resourceCode)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"菜单名称："}},[e._v("\n                                        "+e._s(e.nodeData.resourceName)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"父级编码："}},[e._v("\n                                        "+e._s(e.nodeData.parentCode)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"菜单路由："}},[e._v("\n                                        "+e._s(e.nodeData.router)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"菜单组件："}},[e._v("\n                                        "+e._s(e.nodeData.component)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"菜单图标："}},[e._v("\n                                        "+e._s(e.nodeData.nodeIcon)+"\n                                    ")])],1),e._v(" "),t("div",{staticClass:"form-item-right"},[t("el-form-item",{attrs:{label:"菜单层级："}},[e._v("\n                                        "+e._s(e.resourceLevelShow)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"菜单类型："}},[e._v("\n                                        "+e._s(e.resourceTypeShow)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"展示顺序："}},[e._v("\n                                        "+e._s(e.nodeData.displayOrder)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"是否叶子节点："}},[e._v("\n                                        "+e._s(e.leafFlagShow)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"是否有效："}},[e._v("\n                                        "+e._s(e.activeShow)+"\n                                    ")]),e._v(" "),t("el-form-item",{attrs:{label:"备注："}},[e._v("\n                                        "+e._s(e.nodeData.notes)+"\n                                    ")])],1)])])],1)],1),e._v(" "),t("div",{staticClass:"container-top mt20"},[e._v("权限信息")]),e._v(" "),t("el-container",[t("el-main",{staticStyle:{padding:"20px",height:"320px"}},[t("el-checkbox-group",{on:{change:e.handlePermissionChange},model:{value:e.checkPermissions,callback:function(o){e.checkPermissions=o},expression:"checkPermissions"}},e._l(e.nodeData.permissions,function(e){return t("el-checkbox",{key:e.permissionCode,attrs:{disabled:0==e.editAble,label:e.permissionName}})}))],1)],1)],1)])],1),e._v(" "),t("el-dialog",{attrs:{title:e.resourceDialogTitle,visible:e.resourceDialogVisible,center:""},on:{"update:visible":function(o){e.resourceDialogVisible=o},close:e.resourceCloseDialog}},[t("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.form,rules:e.rules,size:"small",inline:!0}},[t("el-input",{attrs:{type:"hidden","auto-complete":"off"},model:{value:e.form.tid,callback:function(o){e.$set(e.form,"tid",o)},expression:"form.tid"}}),e._v(" "),t("el-form-item",{attrs:{prop:"resourceCode",label:"菜单编码："}},[t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.resourceCode,callback:function(o){e.$set(e.form,"resourceCode",o)},expression:"form.resourceCode"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"resourceName",label:"菜单名称："}},[t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.resourceName,callback:function(o){e.$set(e.form,"resourceName",o)},expression:"form.resourceName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"parentCode",label:"父级菜单："}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.parentCode,callback:function(o){e.$set(e.form,"parentCode",o)},expression:"form.parentCode"}},e._l(e.resourceOptions,function(e){return t("el-option",{key:e.resourceCode,attrs:{label:e.resourceName,value:e.resourceCode}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单路由："}},[t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.router,callback:function(o){e.$set(e.form,"router",o)},expression:"form.router"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单组件："}},[t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.component,callback:function(o){e.$set(e.form,"component",o)},expression:"form.component"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单图标："}},[t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.nodeIcon,callback:function(o){e.$set(e.form,"nodeIcon",o)},expression:"form.nodeIcon"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单层级："}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.resourceLevel,callback:function(o){e.$set(e.form,"resourceLevel",o)},expression:"form.resourceLevel"}},e._l(e.resourceLevelItems,function(e){return t("el-option",{key:e.valueCode,attrs:{label:e.valueName,value:e.valueCode}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单类型："}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.resourceType,callback:function(o){e.$set(e.form,"resourceType",o)},expression:"form.resourceType"}},e._l(e.resourceTypeItems,function(e){return t("el-option",{key:e.valueCode,attrs:{label:e.valueName,value:e.valueCode}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"展示顺序："}},[t("el-input",{attrs:{type:"number","auto-complete":"off"},model:{value:e.form.displayOrder,callback:function(o){e.$set(e.form,"displayOrder",o)},expression:"form.displayOrder"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"是否叶子节点："}},[t("el-checkbox-group",{model:{value:e.form.leafFlag,callback:function(o){e.$set(e.form,"leafFlag",o)},expression:"form.leafFlag"}},[t("el-checkbox",{attrs:{name:"active"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"是否有效："}},[t("el-checkbox-group",{model:{value:e.form.active,callback:function(o){e.$set(e.form,"active",o)},expression:"form.active"}},[t("el-checkbox",{attrs:{name:"active",value:""}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"备注："}},[t("el-input",{attrs:{type:"textarea","auto-complete":"off"},model:{value:e.form.notes,callback:function(o){e.$set(e.form,"notes",o)},expression:"form.notes"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.resourceCloseDialog}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.resourceHandleSubmit}},[e._v("确 定")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.permissionDialogTitle,visible:e.permissionVisible,center:""},on:{"update:visible":function(o){e.permissionVisible=o},close:e.permissionCloseDialog}},[t("el-form",{ref:"permissionForm",attrs:{"label-width":"120px",model:e.permissionForm,rules:e.permissionRules,size:"small",inline:!0}},[t("el-input",{attrs:{type:"hidden","auto-complete":"off"},model:{value:e.permissionForm.tid,callback:function(o){e.$set(e.permissionForm,"tid",o)},expression:"permissionForm.tid"}}),e._v(" "),t("el-form-item",{attrs:{prop:"permissionCode",label:"权限编码："}},[t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.permissionForm.permissionCode,callback:function(o){e.$set(e.permissionForm,"permissionCode",o)},expression:"permissionForm.permissionCode"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"permissionName",label:"权限名称："}},[t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.permissionForm.permissionName,callback:function(o){e.$set(e.permissionForm,"permissionName",o)},expression:"permissionForm.permissionName"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.permissionCloseDialog}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.permissionHandleSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},651:function(e,o,t){var s=t(618);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);t(227)("2c735b43",s,!0)}});